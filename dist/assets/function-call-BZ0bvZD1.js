import{aM as ce,ai as ie,J as O,O as b,af as L,as as re,ar as U,n as ue,Q as P,aN as de,K as H,r as z,H as _,d as D,av as V,a as r,T as F,a4 as p,W as fe,aC as M,z as Y,U as Z,Z as G,M as S,P as ve,h as Q,aB as me,aI as ye,E as he,F as ke,V as A,a7 as Ce,Y as Oe,I as W,aO as ge,a6 as we,aP as Ie,L as be,aQ as Se,j as Pe,aa as pe,aR as xe,aL as Te}from"./index-BHC9SGJp.js";import{u as q}from"./use-expose-DedaC2ld.js";import{u as ze}from"./use-touch-Oq4AsWfP.js";import{P as Be}from"./on-popup-reopen-C12nAhSj.js";import{u as R}from"./use-scope-id-BMLEpVgn.js";function Le(e,{args:o=[],done:t,canceled:a,error:n}){if(e){const s=e.apply(null,o);ce(s)?s.then(l=>{l?t():a&&a()}).catch(n||ie):s?t():a&&a()}else t()}let Ae=2e3;const Ee=()=>++Ae,J={show:Boolean,zIndex:O,overlay:b,duration:O,teleport:[String,Object],lockScroll:b,lazyRender:b,beforeClose:Function,overlayStyle:Object,overlayClass:L,transitionAppear:Boolean,closeOnClickOverlay:b},io=Object.keys(J);let x=0;const $="van-overflow-hidden";function _e(e,o){const t=ze(),a="01",n="10",s=f=>{t.move(f);const i=t.deltaY.value>0?n:a,d=de(f.target,e.value),{scrollHeight:h,offsetHeight:g,scrollTop:w}=d;let m="11";w===0?m=g>=h?"00":"01":w+g>=h&&(m="10"),m!=="11"&&t.isVertical()&&!(parseInt(m,2)&parseInt(i,2))&&H(f,!0)},l=()=>{document.addEventListener("touchstart",t.start),document.addEventListener("touchmove",s,{passive:!1}),x||document.body.classList.add($),x++},u=()=>{x&&(document.removeEventListener("touchstart",t.start),document.removeEventListener("touchmove",s),x--,x||document.body.classList.remove($))},y=()=>o()&&l(),v=()=>o()&&u();re(y),U(v),ue(v),P(o,f=>{f?l():u()})}function X(e){const o=z(!1);return P(e,t=>{t&&(o.value=t)},{immediate:!0}),t=>()=>o.value?t():null}const[De,Me]=_("overlay"),Ne={show:Boolean,zIndex:O,duration:O,className:L,lockScroll:b,lazyRender:b,customStyle:Object};var Re=D({name:De,props:Ne,setup(e,{slots:o}){const t=z(),a=X(()=>e.show||!e.lazyRender),n=l=>{e.lockScroll&&H(l,!0)},s=a(()=>{var l;const u=p(fe(e.zIndex),e.customStyle);return M(e.duration)&&(u.animationDuration=`${e.duration}s`),Y(r("div",{ref:t,style:u,class:[Me(),e.className]},[(l=o.default)==null?void 0:l.call(o)]),[[Z,e.show]])});return V("touchmove",n,{target:t}),()=>r(F,{name:"van-fade",appear:!0},{default:s})}});const $e=G(Re),je=p({},J,{round:Boolean,position:S("center"),closeIcon:S("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:S("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ke,j]=_("popup");var Ue=D({name:Ke,inheritAttrs:!1,props:je,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:t,slots:a}){let n,s;const l=z(),u=z(),y=X(()=>e.show||!e.lazyRender),v=ve(()=>{const c={zIndex:l.value};if(M(e.duration)){const k=e.position==="center"?"animationDuration":"transitionDuration";c[k]=`${e.duration}s`}return c}),f=()=>{n||(n=!0,l.value=e.zIndex!==void 0?+e.zIndex:Ee(),o("open"))},i=()=>{n&&Le(e.beforeClose,{done(){n=!1,o("close"),o("update:show",!1)}})},d=c=>{o("clickOverlay",c),e.closeOnClickOverlay&&i()},h=()=>{if(e.overlay)return r($e,A({show:e.show,class:e.overlayClass,zIndex:l.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},R(),{onClick:d}),{default:a["overlay-content"]})},g=c=>{o("clickCloseIcon",c),i()},w=()=>{if(e.closeable)return r(W,{role:"button",tabindex:0,name:e.closeIcon,class:[j("close-icon",e.closeIconPosition),Oe],classPrefix:e.iconPrefix,onClick:g},null)};let m;const te=()=>{m&&clearTimeout(m),m=setTimeout(()=>{o("opened")})},ne=()=>o("closed"),ae=c=>o("keydown",c),se=y(()=>{var c;const{round:k,position:B,safeAreaInsetTop:E,safeAreaInsetBottom:le}=e;return Y(r("div",A({ref:u,style:v.value,role:"dialog",tabindex:0,class:[j({round:k,[B]:B}),{"van-safe-area-top":E,"van-safe-area-bottom":le}],onKeydown:ae},t,R()),[(c=a.default)==null?void 0:c.call(a),w()]),[[Z,e.show]])}),N=()=>{const{position:c,transition:k,transitionAppear:B}=e,E=c==="center"?"van-fade":`van-popup-slide-${c}`;return r(F,{name:k||E,appear:B,onAfterEnter:te,onAfterLeave:ne},{default:se})};return P(()=>e.show,c=>{c&&!n&&(f(),t.tabindex===0&&Ce(()=>{var k;(k=u.value)==null||k.focus()})),!c&&n&&(n=!1,o("close"))}),q({popupRef:u}),_e(u,()=>e.show&&e.lockScroll),V("popstate",()=>{e.closeOnPopstate&&(i(),s=!1)}),Q(()=>{e.show&&f()}),me(()=>{s&&(o("update:show",!0),s=!1)}),U(()=>{e.show&&e.teleport&&(i(),s=!0)}),ye(Be,()=>e.show),()=>e.teleport?r(he,{to:e.teleport},{default:()=>[h(),N()]}):r(ke,null,[h(),N()])}});const He=G(Ue);let T=0;function Ve(e){e?(T||document.body.classList.add("van-toast--unclickable"),T++):T&&(T--,T||document.body.classList.remove("van-toast--unclickable"))}const[Fe,I]=_("toast"),Ye=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],Ze={icon:String,show:Boolean,type:S("text"),overlay:Boolean,message:O,iconSize:O,duration:Ie(2e3),position:S("middle"),teleport:[String,Object],wordBreak:String,className:L,iconPrefix:String,transition:S("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:L,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:O};var Ge=D({name:Fe,props:Ze,emits:["update:show"],setup(e,{emit:o,slots:t}){let a,n=!1;const s=()=>{const i=e.show&&e.forbidClick;n!==i&&(n=i,Ve(n))},l=i=>o("update:show",i),u=()=>{e.closeOnClick&&l(!1)},y=()=>clearTimeout(a),v=()=>{const{icon:i,type:d,iconSize:h,iconPrefix:g,loadingType:w}=e;if(i||d==="success"||d==="fail")return r(W,{name:i||d,size:h,class:I("icon"),classPrefix:g},null);if(d==="loading")return r(be,{class:I("loading"),size:h,type:w},null)},f=()=>{const{type:i,message:d}=e;if(t.message)return r("div",{class:I("text")},[t.message()]);if(M(d)&&d!=="")return i==="html"?r("div",{key:0,class:I("text"),innerHTML:String(d)},null):r("div",{class:I("text")},[d])};return P(()=>[e.show,e.forbidClick],s),P(()=>[e.show,e.type,e.message,e.duration],()=>{y(),e.show&&e.duration>0&&(a=setTimeout(()=>{l(!1)},e.duration))}),Q(s),ge(s),()=>r(He,A({class:[I([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:u,onClosed:y,"onUpdate:show":l},we(e,Ye)),{default:()=>[v(),f()]})}});function Qe(){const e=Pe({show:!1}),o=n=>{e.show=n},t=n=>{p(e,n,{transitionAppear:!0}),o(!0)},a=()=>o(!1);return q({open:t,close:a,toggle:o}),{open:t,close:a,state:e,toggle:o}}function We(e){const o=Se(e),t=document.createElement("div");return document.body.appendChild(t),{instance:o.mount(t),unmount(){o.unmount(),document.body.removeChild(t)}}}const qe={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let C=[],Je=!1,K=p({},qe);const Xe=new Map;function ee(e){return xe(e)?e:{message:e}}function eo(){const{instance:e,unmount:o}=We({setup(){const t=z(""),{open:a,state:n,close:s,toggle:l}=Qe(),u=()=>{},y=()=>r(Ge,A(n,{onClosed:u,"onUpdate:show":l}),null);return P(t,v=>{n.message=v}),Te().render=y,{open:a,close:s,message:t}}});return e}function oo(){if(!C.length||Je){const e=eo();C.push(e)}return C[C.length-1]}function to(e={}){if(!pe)return{};const o=oo(),t=ee(e);return o.open(p({},K,Xe.get(t.type||K.type),t)),o}const oe=e=>o=>to(p({type:e},ee(o))),ro=oe("loading"),uo=oe("success"),fo=e=>{C.length&&(e?(C.forEach(o=>{o.close()}),C=[]):C[0].close())};export{$e as O,He as P,to as a,io as b,Ge as c,ro as d,fo as e,Le as f,We as m,J as p,uo as s,Qe as u};
